<!DOCTYPE html>
<html>
<head>
</head>
<body>
  <h1>This is the part of the radio app that runs in the radio itself</h1>
  <p>Users never see this page</p>
  <audio id="audio"></audio>
  <audio id="media"></audio>
  <script>
   const playlist_url = "http://radio.timcowlishaw.co.uk/playlist";
  </script>
  <script>
   const req = new XMLHttpRequest();
   let playlist;
   req.open("GET", playlist_url);
   req.onload = function() {
       playlist = JSON.parse(req.response);
       const first_audio = playlist[0].url;
       var audio = document.querySelector("#audio");
       audio.setAttribute("src", first_audio);
       audio.setAttribute("autoplay", "autoplay");
   }
   req.send();
   const ws = new WebSocket('ws://' + location.hostname + ':8000');
    ws.addEventListener('open', function (evt) {
      console.log('connected');
    });
    ws.addEventListener('message', function (evt) {
      const msg = JSON.parse(evt.data);
      console.log(msg);
    });
  </script>
</body>
</html>
